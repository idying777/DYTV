<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0" />
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
    <title>文档</title>
    <link rel="stylesheet" type="text/css" href="../css/api.css" />
    <link rel="stylesheet" type="text/css" href="../css/style.css" />
    <link rel="stylesheet" type="text/css" href="../aui-20170109-v2.1/css/aui.css" />
    <link rel="stylesheet" type="text/css" href="../aui-20170109-v2.1/css/aui-slide.css" />
    <link rel="stylesheet" href="../css/swiper.min.css">


    <style>
      .box{
        text-align:center;
      }
      .ppp{
        float:left;
      }
    .flex-container {

        display: -webkit-box;
        display: -webkit-flex;
        display: flex;
        -webkit-box-orient:horizontal;
        -webkit-flex-flow:row;
        flex-flow: row;
        width: auto;
        height: 12%;
        background-color: #fff;
        overflow: auto;
    }
    .flex-container .flex-item {
      -webkit-box-flex:1;
        -webkit-flex:1;
        flex: 1;
        width: auto;
        height: 100%;

        margin: 1px;
        background-color:lightsalmon;
    }

    .flex-container-2img {

        display: -webkit-box;
        display: -webkit-flex;
        display: flex;
        -webkit-box-orient:horizontal;
        -webkit-flex-flow:row;
        flex-flow: row;
        width: auto;
        height: 12.5%;
        background-color: #fff;
        overflow: auto;
    }
    .flex-container-2img .flex-item-2img {
      -webkit-box-flex:1;
        -webkit-flex:1;
        flex: 1;
        width: auto;
        height: 100%;

        margin: 1px;
        background-color:lightsalmon;
    }
    .maindiv{
      width: auto;
      height: auto;
      position: relative;
    }
    .top_img{
    }
    .empty{ text-align: center; padding: 120px 0; }
        .np {
            background: #eee;
            font-family: Helvetica Neue, Helvetica, Arial, sans-serif;
            font-size: 14px;
            color: #000;
            margin: 0;
            padding: 0;
        }
        .lunbo{
          height:20px;
        }
        .recommand_card {
            box-sizing: border-box;
            -webkit-box-sizing: border-box;
            float: left ;
            width: 19%;
            padding-left: 0px;
            padding-right: 0px;
            text-align: center;
            font-size: 12px;
            margin: 0,0,0,0;
        }

        .recommand_card_below{
            box-sizing: border-box;
            -webkit-box-sizing: border-box;
            float: left;
            width: 50%;
            padding-left: 5px;
            padding-right: 0px;
            text-align: center;
            font-size: 12px;
            margin-bottom: 10px;
        }
        .recommand_card img {
            width: 100%;
        }

        .swiper-container {
            width: 100%;
            height: 10%;
            /*margin: 20px auto;*/
            margin : 2px auto;
        }

        .swiper-slide {
            text-align: center;
            font-size: 18px;
            background: #fff;
            height: auto;
            /* Center slide text vertically */
            /*display: -webkit-box;
            display: -ms-flexbox;
            display: -webkit-flex;
            display: flex;
            -webkit-box-pack: center;
            -ms-flex-pack: center;
            -webkit-justify-content: center;
            justify-content: center;
            -webkit-box-align: center;
            -ms-flex-align: center;
            -webkit-align-items: center;
            align-items: center;*/
        }
        /*.tb{
          height: 50px;
        }*/
    </style>
</head>

<body>
  <!-- 顶部三张图片 3/16 -->
  <!-- <div class='top_img'>
    <ul class="recommand_row">
    		<li class="recommand_card" tapmod="card_hover" >
    			<div  class="innerCard">
    				<img  onclick="window.location.href='http://fanyi.youdao.com/'" src="../image/exm.jpg" />

    			</div>
    		</li>
    		<li class="recommand_card"  tapmod="card_hover" onclick="window.location.href='https://www.baidu.com/?tn=80035161_1_dg'">
    			<div class="innerCard">
    				<img src="../image/exm.jpg" alt=""/>
    			</div>
    		</li>
        <li class="recommand_card"  tapmod="card_hover" onclick="window.location.href='https://www.baidu.com/?tn=80035161_1_dg'">
    			<div class="innerCard">
    				<img src="../image/exm.jpg" alt=""/>
    			</div>
    		</li>
    </ul>
  </div> -->
  <img src='../image/guangdian_top.png' width='100%' height='7%'></img>
  <div class='flex-container'>
      <div class='flex-item'><img src='../image/news2.png' height='100%' width='100%'></img></div>
      <div class='flex-item'><img src='../image/news3.png' height='100%' width='100%'></img></div>
      <div class='flex-item'><img src='../image/news1.png' height='100%' width='100%'></img></div>
  </div>

<!-- 记忆直播栏 5/32 -->
    <div class="np">
        <!-- <ul class="aui-list aui-media-list">
            <li class="aui-list-item">
                <div class="aui-list-item-inner"> -->

                    <div class="swiper-container">
                        <div class="swiper-wrapper">

                            <div class="swiper-slide ">
                                <img id="img_tag1" />
                                <p stype="font-weight:bold;"></p>
                                <marquee behavior="scroll" direction="left" style="color:red">
                                </marquee>
                            </div>
                            <div class="swiper-slide">
                                <img id="img_tag2" />
                                <p stype="font-weight:bold;"></p>
                                <marquee behavior="scroll" direction="left" style="color:red">
                                </marquee>
                            </div>
                            <div class="swiper-slide">
                                <img id="img_tag3" />
                                <p stype="font-weight:bold;"></p>
                                <marquee behavior="scroll" direction="left" style="color:red">
                                </marquee>
                            </div>
                            <div class="swiper-slide">
                                <img id="img_tag4" />
                                <p stype="font-weight:bold;"></p>
                                <marquee behavior="scroll" direction="left" style="color:red">
                                </marquee>
                            </div>
                            <div class="swiper-slide">
                                <img id="img_tag5" />
                                <p stype="font-weight:bold;"></p>
                                <marquee behavior="scroll" direction="left" style="color:red">
                                </marquee>
                            </div>
                        </div>

                    </div>
            <!-- </li>
        </ul>
        </div> -->
      </div>
      <!-- 直播栏 5/32 -->
      <div class="np">
          <!-- <ul class="aui-list aui-media-list">
              <li class="aui-list-item">
                  <div class="aui-list-item-inner"> -->

                      <div class="swiper-container">
                          <div class="swiper-wrapper">
                              <div onclick="saveinfo(1)" class="swiper-slide">
                                  <img id="img_1" />
                                  <p stype="font-weight:bold;"></p>
                                  <marquee behavior="scroll" direction="left" style="color:red">
                                  </marquee>
                              </div>
                              <div onclick="saveinfo(3)" class="swiper-slide">
                                  <img id="img_3" />
                                  <p stype="font-weight:bold;"></p>
                                  <marquee behavior="scroll" direction="left" style="color:red">
                                  </marquee>
                              </div>
                              <div onclick="saveinfo(5)" class="swiper-slide">
                                  <img id="img_5" />
                                  <p stype="font-weight:bold;"></p>
                                  <marquee behavior="scroll" direction="left" style="color:red">
                                  </marquee>
                              </div>
                              <div onclick="saveinfo(7)" class="swiper-slide">
                                  <img id="img_7" />
                                  <p stype="font-weight:bold;"></p>
                                  <marquee behavior="scroll" direction="left" style="color:red">
                                  </marquee>
                              </div>
                              <div onclick="saveinfo(9)" class="swiper-slide">
                                  <img id="img_9" />
                                  <p stype="font-weight:bold;"></p>
                                  <marquee behavior="scroll" direction="left">
                                  </marquee>
                              </div>
                              <div onclick="saveinfo(11)" class="swiper-slide">
                                  <img id="img_11" />
                                  <p stype="font-weight:bold;"></p>
                                  <marquee behavior="scroll" direction="left">
                                  </marquee>
                              </div>
                              <div onclick="saveinfo(13)" class="swiper-slide">
                                  <img id="img_13" />
                                  <p stype="font-weight:bold;"></p>
                                  <marquee behavior="scroll" direction="left">
                                  </marquee>
                              </div>
                              <div onclick="saveinfo(15)" class="swiper-slide">
                                  <img id="img_15" />
                                  <p stype="font-weight:bold;"></p>
                                  <marquee behavior="scroll" direction="left">
                                  </marquee>
                              </div>
                              <div onclick="saveinfo(17)" class="swiper-slide">
                                  <img id="img_17" />
                                  <p stype="font-weight:bold;"></p>
                                  <marquee behavior="scroll" direction="left">
                                  </marquee>
                              </div>
                              <div onclick="saveinfo(19)" class="swiper-slide">
                                  <img id="img_19" />
                                  <p stype="font-weight:bold;"></p>
                                  <marquee behavior="scroll" direction="left">
                                  </marquee>
                              </div>
                              <div onclick="saveinfo(21)" class="swiper-slide">
                                  <img id="img_21" />
                                  <p stype="font-weight:bold;"></p>
                                  <marquee behavior="scroll" direction="left">
                                  </marquee>
                              </div>
                              <div onclick="saveinfo(23)" class="swiper-slide">
                                  <img id="img_23" />
                                  <p stype="font-weight:bold;"></p>
                                  <marquee behavior="scroll" direction="left">
                                  </marquee>
                              </div>
                              <div onclick="saveinfo(25)" class="swiper-slide">
                                  <img id="img_25" />
                                  <p stype="font-weight:bold;"></p>
                                  <marquee behavior="scroll" direction="left">
                                  </marquee>
                              </div>
                              <div onclick="saveinfo(27)" class="swiper-slide">
                                  <img id="img_27" />
                                  <p stype="font-weight:bold;"></p>
                                  <marquee behavior="scroll" direction="left">
                                  </marquee>
                              </div>
                              <div onclick="saveinfo(29)" class="swiper-slide">
                                  <img id="img_29" />
                                  <p stype="font-weight:bold;"></p>
                                  <marquee behavior="scroll" direction="left">
                                  </marquee>
                              </div>
                              <div onclick="saveinfo(31)" class="swiper-slide">
                                  <img id="img_31" />
                                  <p stype="font-weight:bold;"></p>
                                  <marquee behavior="scroll" direction="left">
                                  </marquee>
                              </div>
                          </div>

                      </div>
              <!-- </li>
          </ul>
          </div>-->
        </div>
        <!--<img src='../image/exm.jpg' onclick="showinfo()"></img>-->
        <!-- 直播栏下的轮播图 1/8 -->
      <div id="aui-slide">
            <div class="aui-slide-wrap" >
                <div  class="aui-slide-node bg-dark">
                    <img onclick="fnPlay()" src="../image/test_lunbo.png" />
                </div>
                <div  class="aui-slide-node bg-dark">
                    <img onclick="fnPlay()" src="../image/test2_lunbo.png" />
                </div>
            </div>
            <div class="aui-slide-page-wrap"></div>
        </div>
        <!-- 两张图片 1/8 -->
        <div class='flex-container-2img'>
            <div class='flex-item-2img'><img src='../image/action1.png' height='100%' width='100%'></img></div>
            <div class='flex-item-2img'><img src='../image/action2.png' height='100%' width='100%'></img></div>
        </div>

        <!-- 点播类容列表 1/4 -->
        <!-- <div class="aui-searchbar" id="search">
          <div class="aui-searchbar-input aui-border-radius">
              <i class="aui-iconfont aui-icon-search"></i>
              <input type="search" placeholder="请输入搜索内容" id="search-input">
              <div class="aui-searchbar-clear-btn">
                  <i class="aui-iconfont aui-icon-close"></i>
              </div>
          </div>
          <div class="aui-searchbar-btn" tapmode>取消</div>
        </div> -->
        <img class='ppp' src='../image/dianbo_sousuo.png' width='50%' height="5%"></img>
        <img class='ppp' src='../image/dianbo_shoucang.png' width='25%' height="5%"></img>
        <img class='ppp' src='../image/dianbo_jilu.png' width='25%' height="5%"></img>

        <img class='ppp' src='../image/dianbo_test.png' width='50%' height="15%"></img>
        <img class='ppp' src='#' width='45%' height='2.5%' style="opacity:0;"></img>
        <img class='ppp' src='./menu/dianying.png' width='16.5%'></img>
        <img class='ppp' src='./menu/dianshiju.png' width='16.5%'></img>
        <img class='ppp' src='./menu/zongyi.png' width='16.5%'> </img>
</body>

</html>
<script src="../script/swiper.min.js"></script>
<script type="text/javascript" src="../script/api.js"></script>
<script type="text/javascript" src="../aui-20170109-v2.1/script/api.js"></script>
<script type="text/javascript" src="../aui-20170109-v2.1/script/aui-slide.js"></script>


<script type="text/javascript">

    var videoPlayer;
    var swiper = new Swiper('.swiper-container', {
      pagination: '.swiper-pagination',
       slidesPerView: 5,
       paginationClickable: false,
       spaceBetween: 2,
       freeMode: true,

   });


    apiready = function() {
      if(!$api.getStorage('tag1')){
        j= -1
        for(i=1;i<=5;i++){
          j += 2
          $api.setStorage('tag'+i,j);
        }
      }
        loading()
        var obj = api.require('dlna');
        videoPlayer = api.require('videoPlayer');
        var slide = new auiSlide({
            container: document.getElementById("aui-slide"),
            // "width":300,
            "height": api.winHeight/8,
            "speed": 300,
            "pageShow": true,
            "pageStyle": 'dot',
            "loop": true,
            "autoPlay": 3000, //自动播放
            'dotPosition': 'center',
            currentPage: currentFun
        })

        function currentFun(index) {
            // console.log(index);
        }
        api.addEventListener({
            name: "keyback"
        }, function(ret, err) {
            api.closeWin();

        });
    }

    function saveinfo(index){
      var flag = true
      var temp = 5
      for(i=2;i<=5;i++){
        if(index == $api.getStorage('tag'+i)){
          temp = i
        }
        if(index == $api.getStorage('tag1'))
          flag = false
      }
      if(flag){
        var img_id = 'img_' + index
        var imgdom = $api.byId(img_id)
        var usual_img = $api.byId('img_tag1');
        for(i=temp;i>=2;i--){
          j = i - 1
          var before_img = $api.byId('img_tag'+j);
          var current_img = $api.byId('img_tag'+i);
          var before_tag = $api.attr(before_img,'tag')
          $api.attr(current_img,'tag',before_tag)
          $api.setStorage('tag'+i, before_tag);

        }
        $api.attr(usual_img,'tag',index)
        $api.setStorage('tag1', index);
      }
    }


    function showinfo(){
      for(i=1;i<=5;i++){
        var tag = 'tag' + i
        alert($api.getStorage(tag))
      }
    }
    // 获取epg信息
    function getepg(str,path,index){
        api.ajax({
            url: path,
            method: 'get',
            dataType: 'xml',
            charset: 'gb2312',
        }, function(ret, err) {
            if (ret) {
                var parser = new DOMParser();
                var xmlDom = parser.parseFromString(ret, "text/xml");
                x = xmlDom.getElementsByTagName('eventlist')
                var image = $api.byId(str+index);
                var p2 = $api.next($api.next(image));
                $api.attr(p2,'style','font-size:10px;color:red')
                var title = x[0].childNodes[1].getAttribute("title")
                //var title = 'test epg'
                $api.text(p2,title)
                $api.attr(p2,"scrollamount","3")
            } else {
            }
        });
    }
    // 跳转视频播放
    function fnOpenContrlframe(path) {
        api.openFrame({
            name: 'video',
            url: 'video.html',
            rect: {
                x: 0,
                y: 0,
                w: 'auto',
                h: 'auto'

            },
            pageParam:{
              video_path : path,
              player : videoPlayer
            },
            bounces: false,
            bgColor: 'rgba(0,0,0,0)',
            vScrollBarEnabled: false,
            hScrollBarEnabled: false
        });
        loading();
        // videoPlayer.fullScreen();

    }
    // 视频关闭
    function fnvBack(){
      api.closeFrame({
        name:'video'
      });
    }
    // 获取直播数据
    function loading(){
      for(i=1;i<=5;i++){
        $api.attr($api.byId('img_tag'+i),"tag",$api.getStorage('tag'+i))
      }
      api.ajax({
          url: 'http://113.57.128.2:7998/iptv/iptvx650cboy.xml',
          method: 'get',
          dataType: 'xml',
          charset: 'gb2312',
      }, function(ret, err) {
          if (ret) {
              var parser = new DOMParser();
              var xmlDom = parser.parseFromString(ret, "text/xml");
              x = xmlDom.getElementsByTagName('group')
              for (j = 1; j <= 31; j += 2) {
                  var epgpath = "http://113.57.128.2:7998/iptv/"+x[0].childNodes[j].getAttribute("id")+".xml"
                  var str = "http://113.57.128.2:7998/iptv/taibiao";
                  var str_path = "fnOpenContrlframe('"+x[0].childNodes[j].getAttribute("unicast")+"')";
                  var p1_str = x[0].childNodes[j].getAttribute("name");
                  if(p1_str.charCodeAt(0) > 255)
                    p1_str = p1_str.substring(0,4)
                  p1_str = p1_str.substring(0,7)
                  if (x[0].childNodes[j].getAttribute("taibiao") == "1") {
                      str += ("-" + x[0].childNodes[j].getAttribute("id") + ".jpg");
                  } else {
                      str += ".jpg";
                  }
                  for(i=1;i<=5;i++){
                    if(j == $api.getStorage('tag'+i)){
                        var img_tag_dom = $api.byId('img_tag'+i);
                        var img_tag_dom_next = $api.next(img_tag_dom)
                        $api.attr(img_tag_dom,'src',str)
                        $api.attr(img_tag_dom,"onclick",str_path)
                        $api.text(img_tag_dom_next,p1_str)
                        getepg('img_tag',epgpath,i)
                    }
                  }
                  // var unicast = "window.location.href='" + x[0].childNodes[j].getAttribute("unicast") + "'";
                  var image_id = 'img_' + j;
                  var image = $api.byId(image_id);
                  var next_p1 = $api.next(image);
                  $api.attr(image, "src", str);
                  $api.attr(image,"onclick",str_path)
                  $api.text(next_p1,p1_str);
                  // $api.attr(image,"onclick",unicast);
                  //window.location.href='http://113.57.128.2:7999/live/ch_20037/iptvx650cboy.m3u8'
                  getepg('img_',epgpath,j)
              }

          } else {
              alert("false");
          }
      });
    }
</script>
